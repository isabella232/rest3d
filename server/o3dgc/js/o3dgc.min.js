var o3dgc=function(){function O(a,d,b){var e,f,s,m;e=-1;f=!1;m=d.m_value;for(s=0;s<m;++s)if(a.Equal(b[s])){f=!0;break}else if(a.Less(b[s])){d.m_value<g.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&++d.m_value;for(e=d.m_value-1;e>s;--e)b[e].m_a=b[e-1].m_a,b[e].m_b=b[e-1].m_b,b[e].m_c=b[e-1].m_c;b[s].m_a=a.m_a;b[s].m_b=a.m_b;b[s].m_c=a.m_c;e=s;f=!0;break}!f&&d.m_value<g.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&(e=d.m_value++,b[e].m_a=a.m_a,b[e].m_b=a.m_b,b[e].m_c=a.m_c);return e}function I(a){return a&1?-(a+
1>>>1):a>>>1}function K(a,d,c,e,f){var s,g,l;l=new b.SC3DMCTriplet(-1,-1,-1);for(s=0;3>s;++s)g=a[3*d+s],g<c&&(l.m_a=-1,l.m_b=-1,l.m_c=g,O(l,e,f))}function P(a,d,c,e,f,s,g){var l,h,k,n,p,q,w,t;l=3*d;t=new b.SC3DMCTriplet(-1,-1,-1);a[l]===c?(d=a[l+1],l=a[l+2]):a[l+1]===c?(d=a[l],l=a[l+2]):(d=a[l],l=a[l+1]);if(d<c&&l<c)for(q=s.Begin(d),s=s.End(d);q<s;++q){h=g[q];if(0>h)break;h*=3;k=-1;w=!1;for(p=0;3>p;++p)n=a[h+p],n===l?w=!0:n<c&&n!==d&&(k=n);-1!==k&&w&&(d<l?(t.m_a=d,t.m_b=l):(t.m_a=l,t.m_b=d),t.m_c=
-k-1,O(t,e,f))}}var b,g;b={};g={O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0:7,O3DGC_BINARY_STREAM_MAX_SYMBOL0:127,O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1:6,O3DGC_BINARY_STREAM_MAX_SYMBOL1:63,O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32:5,O3DGC_BIG_ENDIAN:0,O3DGC_LITTLE_ENDIAN:1,O3DGC_MAX_DOUBLE:1.79769E308,O3DGC_MIN_LONG:-2147483647,O3DGC_MAX_LONG:2147483647,O3DGC_MAX_UCHAR8:255,O3DGC_MAX_TFAN_SIZE:256,O3DGC_MAX_ULONG:4294967295,O3DGC_SC3DMC_START_CODE:497,O3DGC_DV_START_CODE:498,O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES:256,
O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES:256,O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES:32,O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS:2,O3DGC_SC3DMC_BINARIZATION_FL:0,O3DGC_SC3DMC_BINARIZATION_BP:1,O3DGC_SC3DMC_BINARIZATION_FC:2,O3DGC_SC3DMC_BINARIZATION_AC:3,O3DGC_SC3DMC_BINARIZATION_AC_EGC:4,O3DGC_SC3DMC_BINARIZATION_ASCII:5,O3DGC_STREAM_TYPE_UNKOWN:0,O3DGC_STREAM_TYPE_ASCII:1,O3DGC_STREAM_TYPE_BINARY:2,O3DGC_SC3DMC_NO_PREDICTION:0,O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION:1,O3DGC_SC3DMC_XOR_PREDICTION:2,O3DGC_SC3DMC_ADAPTIVE_DIFFERENTIAL_PREDICTION:3,
O3DGC_SC3DMC_CIRCULAR_DIFFERENTIAL_PREDICTION:4,O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION:5,O3DGC_SC3DMC_SURF_NORMALS_PREDICTION:6,O3DGC_SC3DMC_ENCODE_MODE_QBCR:0,O3DGC_SC3DMC_ENCODE_MODE_SVA:1,O3DGC_SC3DMC_ENCODE_MODE_TFAN:2,O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT:0,O3DGC_MIN_NEIGHBORS_SIZE:128,O3DGC_MIN_NUM_NEIGHBORS_SIZE:16,O3DGC_TFANS_MIN_SIZE_ALLOCATED_VERTICES_BUFFER:128,O3DGC_TFANS_MIN_SIZE_TFAN_SIZE_BUFFER:8,O3DGC_DEFAULT_VECTOR_SIZE:32};b.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_UNKOWN=0;b.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_POSITION=
1;b.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_NORMAL=2;b.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_COLOR=3;b.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_TEXCOORD=4;b.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_WEIGHT=5;b.O3DGC_IFS_INT_ATTRIBUTE_TYPE_UNKOWN=0;b.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX=1;b.O3DGC_IFS_INT_ATTRIBUTE_TYPE_JOINT_ID=2;b.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX_BUFFER_ID=3;b.O3DGC_OK=0;b.O3DGC_ERROR_BUFFER_FULL=1;b.O3DGC_ERROR_CORRUPTED_STREAM=5;b.O3DGC_ERROR_NON_SUPPORTED_FEATURE=6;b.O3DGC_ERROR_AC=7;b.SC3DMCStats=function(){this.m_timeCoordIndex=
this.m_timeNormal=this.m_timeCoord=0;this.m_timeFloatAttribute=new Float32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);this.m_timeIntAttribute=new Float32Array(g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES);this.m_streamSizeCoordIndex=this.m_streamSizeNormal=this.m_streamSizeCoord=this.m_timeReorder=0;this.m_streamSizeFloatAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);this.m_streamSizeIntAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES)};b.SC3DMCTriplet=function(a,d,
b){this.m_a=a;this.m_b=d;this.m_c=b};b.SC3DMCTriplet.prototype.Less=function(a){return this.m_c!==a.m_c?this.m_c<a.m_c:this.m_b!==a.m_b?this.m_b<a.m_b:this.m_a<a.m_a};b.SC3DMCTriplet.prototype.Equal=function(a){return this.m_c===a.m_c&&this.m_b===a.m_b&&this.m_a===a.m_a};"undefined"===typeof window.performance&&(window.performance={});window.performance.now||(g.nowOffset=Date.now(),performance.timing&&performance.timing.navigationStart&&(g.nowOffset=performance.timing.navigationStart),window.performance.now=
function(){return Date.now()-g.nowOffset});b.Timer=function(){this.m_end=this.m_start=0};b.Timer.prototype.Tic=function(){this.m_start=window.performance.now()};b.Timer.prototype.Toc=function(){this.m_end=window.performance.now()};b.Timer.prototype.GetElapsedTime=function(){return this.m_end-this.m_start};b.Vec3=function(a,d,b){this.m_x=a;this.m_y=d;this.m_z=b};b.Vec3.prototype.Set=function(a,d,b){this.m_x=a;this.m_y=d;this.m_z=b};b.Vec3.prototype.Sub=function(a,d){this.m_x=a.m_x-d.m_x;this.m_y=a.m_y-
d.m_y;this.m_z=a.m_z-d.m_z};b.Vec3.prototype.Add=function(a,d){this.m_x=a.m_x+d.m_x;this.m_y=a.m_y+d.m_y;this.m_z=a.m_z+d.m_z};b.Vec3.prototype.SelfAdd=function(a){this.m_x+=a.m_x;this.m_y+=a.m_y;this.m_z+=a.m_z};b.Vec3.prototype.Cross=function(a,d){this.m_x=a.m_y*d.m_z-a.m_z*d.m_y;this.m_y=a.m_z*d.m_x-a.m_x*d.m_z;this.m_z=a.m_x*d.m_y-a.m_y*d.m_x};b.Vec3.prototype.GetNorm=function(){return Math.sqrt(this.m_x*this.m_x+this.m_y*this.m_y+this.m_z*this.m_z)};g.CubeToSphere={0:function(a,d){d.m_x=a.m_x;
d.m_y=a.m_y;d.m_z=Math.sqrt(Math.max(0,1-d.m_x*d.m_x-d.m_y*d.m_y))},1:function(a,d){d.m_x=-a.m_x;d.m_y=-a.m_y;d.m_z=-Math.sqrt(Math.max(0,1-d.m_x*d.m_x-d.m_y*d.m_y))},2:function(a,d){d.m_z=a.m_x;d.m_x=a.m_y;d.m_y=Math.sqrt(Math.max(0,1-d.m_x*d.m_x-d.m_z*d.m_z))},3:function(a,d){d.m_z=-a.m_x;d.m_x=-a.m_y;d.m_y=-Math.sqrt(Math.max(0,1-d.m_x*d.m_x-d.m_z*d.m_z))},4:function(a,d){d.m_y=a.m_x;d.m_z=a.m_y;d.m_x=Math.sqrt(Math.max(0,1-d.m_y*d.m_y-d.m_z*d.m_z))},5:function(a,d){d.m_y=-a.m_x;d.m_z=-a.m_y;d.m_x=
-Math.sqrt(Math.max(0,1-d.m_y*d.m_y-d.m_z*d.m_z))}};b.Iterator=function(){this.m_count=0};b.NumberRef=function(){this.m_value=0};b.BinaryStream=function(a){var d;var b;b=new ArrayBuffer(4);d=new Uint32Array(b);b=new Uint8Array(b);d[0]=1;d=1===b[0]?g.O3DGC_LITTLE_ENDIAN:g.O3DGC_BIG_ENDIAN;this.m_endianness=d;this.m_buffer=a;this.m_stream=new Uint8Array(this.m_buffer);this.m_localBuffer=new ArrayBuffer(4);this.m_localBufferViewUChar8=new Uint8Array(this.m_localBuffer);this.m_localBufferViewFloat32=
new Float32Array(this.m_localBuffer);this.m_localBufferViewUInt32=new Uint32Array(this.m_localBuffer)};b.BinaryStream.prototype.ReadFloat32Bin=function(a){this.m_endianness===g.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[a.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[1]=
this.m_stream[a.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[a.m_count++]);return this.m_localBufferViewFloat32[0]};b.BinaryStream.prototype.ReadUInt32Bin=function(a){this.m_endianness===g.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[a.m_count++]):
(this.m_localBufferViewUChar8[0]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[a.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[a.m_count++]);return this.m_localBufferViewUInt32[0]};b.BinaryStream.prototype.ReadUChar8Bin=function(a){return this.m_stream[a.m_count++]};b.BinaryStream.prototype.ReadUInt32ASCII=function(a){var b,c,e;for(e=c=b=0;e<g.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32;++e)b+=this.m_stream[a.m_count++]<<
c>>>0,c+=g.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0;return b};b.BinaryStream.prototype.ReadFloat32ASCII=function(a){a=this.ReadUInt32ASCII(a);this.m_endianness===g.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=a&g.O3DGC_MAX_UCHAR8,a>>>=8,this.m_localBufferViewUChar8[2]=a&g.O3DGC_MAX_UCHAR8,a>>>=8,this.m_localBufferViewUChar8[1]=a&g.O3DGC_MAX_UCHAR8,this.m_localBufferViewUChar8[0]=a>>>8&g.O3DGC_MAX_UCHAR8):(this.m_localBufferViewUChar8[0]=a&g.O3DGC_MAX_UCHAR8,a>>>=8,this.m_localBufferViewUChar8[1]=
a&g.O3DGC_MAX_UCHAR8,a>>>=8,this.m_localBufferViewUChar8[2]=a&g.O3DGC_MAX_UCHAR8,a>>>=8,this.m_localBufferViewUChar8[3]=a&g.O3DGC_MAX_UCHAR8);return this.m_localBufferViewFloat32[0]};b.BinaryStream.prototype.ReadIntASCII=function(a){return I(this.ReadUIntASCII(a))};b.BinaryStream.prototype.ReadUIntASCII=function(a){var b,c,e;e=this.m_stream[a.m_count++];if(e===g.O3DGC_BINARY_STREAM_MAX_SYMBOL0){b=0;do c=this.m_stream[a.m_count++],e+=c>>>1<<b>>>0,b+=g.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1;while(c&1)}return e};
b.BinaryStream.prototype.ReadUCharASCII=function(a){return this.m_stream[a.m_count++]};b.BinaryStream.prototype.ReadFloat32=function(a,b){return b===g.O3DGC_STREAM_TYPE_ASCII?this.ReadFloat32ASCII(a):this.ReadFloat32Bin(a)};b.BinaryStream.prototype.ReadUInt32=function(a,b){return b===g.O3DGC_STREAM_TYPE_ASCII?this.ReadUInt32ASCII(a):this.ReadUInt32Bin(a)};b.BinaryStream.prototype.ReadUChar=function(a,b){return b===g.O3DGC_STREAM_TYPE_ASCII?this.ReadUCharASCII(a):this.ReadUChar8Bin(a)};b.BinaryStream.prototype.GetBuffer=
function(a,b){return new Uint8Array(this.m_buffer,a.m_count,b)};g.O3DGC_AC_MIN_LENGTH=16777216;g.O3DGC_AC_MAX_LENGTH=4294967295;g.O3DGC_AC_BM_LENGTH_SHIFT=13;g.O3DGC_AC_BM_MAX_COUNT=1<<g.O3DGC_AC_BM_LENGTH_SHIFT>>>0;g.O3DGC_AC_DM_LENGTH_SHIFT=15;g.O3DGC_AC_DM_MAX_COUNT=1<<g.O3DGC_AC_DM_LENGTH_SHIFT>>>0;b.StaticBitModel=function(){this.m_bit0Prob=1<<g.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0};b.StaticBitModel.prototype.SetProbability=function(a){this.m_bit0Prob=Math.floor(a*(1<<g.O3DGC_AC_BM_LENGTH_SHIFT>>>
0))};b.AdaptiveBitModel=function(){this.m_bitsUntilUpdate=this.m_updateCycle=4;this.m_bit0Prob=1<<g.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0;this.m_bit0Count=1;this.m_bitCount=2};b.AdaptiveBitModel.prototype.Reset=function(){this.m_bitsUntilUpdate=this.m_updateCycle=4;this.m_bit0Prob=1<<g.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0;this.m_bit0Count=1;this.m_bitCount=2};b.AdaptiveBitModel.prototype.Update=function(){(this.m_bitCount+=this.m_updateCycle)>g.O3DGC_AC_BM_MAX_COUNT&&(this.m_bitCount=this.m_bitCount+1>>>1,this.m_bit0Count=
this.m_bit0Count+1>>>1,this.m_bit0Count===this.m_bitCount&&++this.m_bitCount);this.m_bit0Prob=this.m_bit0Count*Math.floor(2147483648/this.m_bitCount)>>>31-g.O3DGC_AC_BM_LENGTH_SHIFT;this.m_updateCycle=5*this.m_updateCycle>>>2;64<this.m_updateCycle&&(this.m_updateCycle=64);this.m_bitsUntilUpdate=this.m_updateCycle};b.AdaptiveDataModel=function(){this.m_buffer={};this.m_distribution={};this.m_symbolCount={};this.m_decoderTable={};this.m_tableShift=this.m_tableSize=this.m_lastSymbol=this.m_dataSymbols=
this.m_symbolsUntilUpdate=this.m_updateCycle=this.m_totalCount=0};b.AdaptiveDataModel.prototype.Update=function(){var a,b,c,e,f;if((this.m_totalCount+=this.m_updateCycle)>g.O3DGC_AC_DM_MAX_COUNT)for(a=this.m_totalCount=0;a<this.m_dataSymbols;++a)this.m_totalCount+=this.m_symbolCount[a]=this.m_symbolCount[a]+1>>>1;b=a=0;c=Math.floor(2147483648/this.m_totalCount);if(0===this.m_tableSize)for(e=0;e<this.m_dataSymbols;++e)this.m_distribution[e]=c*a>>>31-g.O3DGC_AC_DM_LENGTH_SHIFT,a+=this.m_symbolCount[e];
else{for(e=0;e<this.m_dataSymbols;++e)for(this.m_distribution[e]=c*a>>>31-g.O3DGC_AC_DM_LENGTH_SHIFT,a+=this.m_symbolCount[e],f=this.m_distribution[e]>>>this.m_tableShift;b<f;)this.m_decoderTable[++b]=e-1;for(this.m_decoderTable[0]=0;b<=this.m_tableSize;)this.m_decoderTable[++b]=this.m_dataSymbols-1}this.m_updateCycle=5*this.m_updateCycle>>>2;a=this.m_dataSymbols+6<<3>>>0;this.m_updateCycle>a&&(this.m_updateCycle=a);this.m_symbolsUntilUpdate=this.m_updateCycle};b.AdaptiveDataModel.prototype.Reset=
function(){var a;if(0!==this.m_dataSymbols){this.m_totalCount=0;this.m_updateCycle=this.m_dataSymbols;for(a=0;a<this.m_dataSymbols;++a)this.m_symbolCount[a]=1;this.Update();this.m_symbolsUntilUpdate=this.m_updateCycle=this.m_dataSymbols+6>>>1}};b.AdaptiveDataModel.prototype.SetAlphabet=function(a){if(2>a||2048<a)return Console.log("invalid number of data symbols"),b.O3DGC_ERROR_AC;if(this.m_dataSymbols!==a)if(this.m_dataSymbols=a,this.m_lastSymbol=this.m_dataSymbols-1,16<this.m_dataSymbols){for(a=
3;this.m_dataSymbols>1<<a+2>>>0;)++a;this.m_tableSize=1<<a>>>0;this.m_tableShift=g.O3DGC_AC_DM_LENGTH_SHIFT-a;this.m_buffer=new ArrayBuffer(4*(2*this.m_dataSymbols+this.m_tableSize+2));this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols);this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols);this.m_decoderTable=new Uint32Array(this.m_buffer,8*this.m_dataSymbols,this.m_tableSize+2)}else this.m_tableSize=this.m_tableShift=0,this.m_buffer=new ArrayBuffer(8*
this.m_dataSymbols),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable={};this.Reset();return b.O3DGC_OK};b.ArithmeticDecoder=function(){this.m_codeBuffer={};this.m_mode=this.m_bufferSize=this.m_length=this.m_value=this.m_base=this.m_acShift=0};b.ArithmeticDecoder.prototype.SetBuffer=function(a,d){if(0===a)return Console.log("invalid codec buffer size"),b.O3DGC_ERROR_AC;
if(0!==this.m_mode)return Console.log("cannot set buffer while encoding or decoding"),b.O3DGC_ERROR_AC;this.m_bufferSize=a;this.m_codeBuffer=d};b.ArithmeticDecoder.prototype.StartDecoder=function(){if(0!==this.m_mode)return Console.log("cannot start decoder"),b.O3DGC_ERROR_AC;if(0===this.m_bufferSize)return Console.log("no code buffer set"),b.O3DGC_ERROR_AC;this.m_mode=2;this.m_length=g.O3DGC_AC_MAX_LENGTH;this.m_acShift=3;this.m_value=(this.m_codeBuffer[0]<<24|this.m_codeBuffer[1]<<16|this.m_codeBuffer[2]<<
8|this.m_codeBuffer[3])>>>0};b.ArithmeticDecoder.prototype.StopDecoder=function(){if(2!==this.m_mode)return Console.log("invalid to stop decoder"),b.O3DGC_ERROR_AC;this.m_mode=0};b.ArithmeticDecoder.prototype.GetBit=function(){this.m_length>>>=1;var a=this.m_value>=this.m_length;a&&(this.m_value-=this.m_length);this.m_length<g.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval();return a};b.ArithmeticDecoder.prototype.GetBits=function(a){a=Math.floor(this.m_value/(this.m_length>>>=a));this.m_value-=this.m_length*
a;this.m_length<g.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval();return a};b.ArithmeticDecoder.prototype.DecodeStaticBitModel=function(a){var b;a=a.m_bit0Prob*(this.m_length>>>g.O3DGC_AC_BM_LENGTH_SHIFT);(b=this.m_value>=a)?(this.m_value-=a,this.m_length-=a):this.m_length=a;this.m_length<g.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval();return b};b.ArithmeticDecoder.prototype.DecodeAdaptiveBitModel=function(a){var b,c;b=a.m_bit0Prob*(this.m_length>>>g.O3DGC_AC_BM_LENGTH_SHIFT);(c=this.m_value>=b)?(this.m_value-=
b,this.m_length-=b):(this.m_length=b,++a.m_bit0Count);this.m_length<g.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval();0===--a.m_bitsUntilUpdate&&a.Update();return c};b.ArithmeticDecoder.prototype.DecodeAdaptiveDataModel=function(a){var b,c,e,f,s,m;f=this.m_length;if(0<a.m_tableSize){e=Math.floor(this.m_value/(this.m_length>>>=g.O3DGC_AC_DM_LENGTH_SHIFT));b=e>>>a.m_tableShift;c=a.m_decoderTable[b];for(b=a.m_decoderTable[b+1]+1;b>c+1;)m=c+b>>>1,a.m_distribution[m]>e?b=m:c=m;e=a.m_distribution[c]*this.m_length;
c!==a.m_lastSymbol&&(f=a.m_distribution[c+1]*this.m_length)}else{e=c=0;this.m_length>>>=g.O3DGC_AC_DM_LENGTH_SHIFT;m=(b=a.m_dataSymbols)>>>1;do s=this.m_length*a.m_distribution[m],s>this.m_value?(b=m,f=s):(c=m,e=s);while((m=c+b>>>1)!==c)}this.m_value-=e;this.m_length=f-e;this.m_length<g.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval();++a.m_symbolCount[c];0===--a.m_symbolsUntilUpdate&&a.Update(!1);return c};b.ArithmeticDecoder.prototype.ExpGolombDecode=function(a,b,c){var e,f,g;f=e=0;do if(g=this.DecodeAdaptiveBitModel(c))e+=
1<<a>>>0,a++;while(g);for(;a--;)this.DecodeStaticBitModel(b)&&(f=(f|1<<a)>>>0);return e+f};b.ArithmeticDecoder.prototype.RenormDecInterval=function(){do this.m_value=(this.m_value<<8|this.m_codeBuffer[++this.m_acShift])>>>0,this.m_length=this.m_length<<8>>>0;while(this.m_length<g.O3DGC_AC_MIN_LENGTH)};b.ArithmeticDecoder.prototype.DecodeIntACEGC=function(a,b,c,e,f){a=this.DecodeAdaptiveDataModel(a);a===f&&(a+=this.ExpGolombDecode(e,b,c));return I(a)};b.ArithmeticDecoder.prototype.DecodeUIntACEGC=
function(a,b,c,e,f){a=this.DecodeAdaptiveDataModel(a);a===f&&(a+=this.ExpGolombDecode(e,b,c));return a};b.FIFO=function(){this.m_data={};this.m_end=this.m_start=this.m_size=this.m_allocated=0};b.FIFO.prototype.Clear=function(){this.m_start=this.m_end=this.m_size=0};b.FIFO.prototype.GetAllocatedSize=function(){return this.m_allocated};b.FIFO.prototype.GetSize=function(){return this.m_size};b.FIFO.prototype.Allocate=function(a){a>this.m_allocated&&(this.m_allocated=a,this.m_data=new Int32Array(this.m_allocated));
this.Clear();return b.O3DGC_OK};b.FIFO.prototype.PopFirst=function(){--this.m_size;var a=this.m_start++;this.m_start===this.m_allocated&&(this.m_end=0);return this.m_data[a]};b.FIFO.prototype.PushBack=function(a){--this.m_size;this.m_data[this.m_end]=a;++this.m_size;++this.m_end;this.m_end===this.m_allocated&&(this.m_end=0)};b.IndexedFaceSet=function(){this.m_numIntAttributes=this.m_numFloatAttributes=this.m_nNormal=this.m_nCoord=this.m_nCoordIndex=0;this.m_creaseAngle=30;this.m_isTriangularMesh=
this.m_convex=this.m_solid=this.m_ccw=!0;this.m_coordMin=new Float32Array(3);this.m_coordMax=new Float32Array(3);this.m_normalMin=new Float32Array(3);this.m_normalMax=new Float32Array(3);this.m_nFloatAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);this.m_nIntAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES);this.m_dimFloatAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);this.m_dimIntAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES);
this.m_typeFloatAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);this.m_typeIntAttribute=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES);this.m_minFloatAttributeBuffer=new ArrayBuffer(4*g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES);this.m_minFloatAttribute=new Float32Array(this.m_minFloatAttributeBuffer);this.m_maxFloatAttributeBuffer=new ArrayBuffer(4*g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES);this.m_maxFloatAttribute=
new Float32Array(this.m_maxFloatAttributeBuffer);this.m_coordIndex={};this.m_coord={};this.m_normal={};this.m_floatAttribute=[];this.m_intAttribute=[]};b.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex};b.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex};b.IndexedFaceSet.prototype.GetNCoord=function(){return this.m_nCoord};b.IndexedFaceSet.prototype.GetNNormal=function(){return this.m_nNormal};b.IndexedFaceSet.prototype.GetNFloatAttribute=function(a){return this.m_nFloatAttribute[a]};
b.IndexedFaceSet.prototype.GetNIntAttribute=function(a){return this.m_nIntAttribute[a]};b.IndexedFaceSet.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes};b.IndexedFaceSet.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes};b.IndexedFaceSet.prototype.GetCoordMinArray=function(){return this.m_coordMin};b.IndexedFaceSet.prototype.GetCoordMaxArray=function(){return this.m_coordMax};b.IndexedFaceSet.prototype.GetNormalMinArray=function(){return this.m_normalMin};
b.IndexedFaceSet.prototype.GetNormalMaxArray=function(){return this.m_normalMax};b.IndexedFaceSet.prototype.GetFloatAttributeMinArray=function(a){return new Float32Array(this.m_minFloatAttributeBuffer,4*a*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES,this.GetFloatAttributeDim(a))};b.IndexedFaceSet.prototype.GetFloatAttributeMaxArray=function(a){return new Float32Array(this.m_maxFloatAttributeBuffer,4*a*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES,this.GetFloatAttributeDim(a))};b.IndexedFaceSet.prototype.GetFloatAttributeDim=
function(a){return this.m_dimFloatAttribute[a]};b.IndexedFaceSet.prototype.GetIntAttributeDim=function(a){return this.m_dimIntAttribute[a]};b.IndexedFaceSet.prototype.GetFloatAttributeType=function(a){return this.m_typeFloatAttribute[a]};b.IndexedFaceSet.prototype.GetIntAttributeType=function(a){return this.m_typeIntAttribute[a]};b.IndexedFaceSet.prototype.GetFloatAttributeMax=function(a,b){return this.m_maxFloatAttribute[a*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+b]};b.IndexedFaceSet.prototype.GetCreaseAngle=
function(){return this.m_creaseAngle};b.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle};b.IndexedFaceSet.prototype.GetCCW=function(){return this.m_ccw};b.IndexedFaceSet.prototype.GetSolid=function(){return this.m_solid};b.IndexedFaceSet.prototype.GetConvex=function(){return this.m_convex};b.IndexedFaceSet.prototype.GetIsTriangularMesh=function(){return this.m_isTriangularMesh};b.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex};b.IndexedFaceSet.prototype.GetCoordIndex=
function(){return this.m_coordIndex};b.IndexedFaceSet.prototype.GetCoord=function(){return this.m_coord};b.IndexedFaceSet.prototype.GetNormal=function(){return this.m_normal};b.IndexedFaceSet.prototype.GetFloatAttribute=function(a){return this.m_floatAttribute[a]};b.IndexedFaceSet.prototype.GetIntAttribute=function(a){return this.m_intAttribute[a]};b.IndexedFaceSet.prototype.SetNCoordIndex=function(a){this.m_nCoordIndex=a};b.IndexedFaceSet.prototype.SetNNormalIndex=function(a){};b.IndexedFaceSet.prototype.SetNormalPerVertex=
function(a){};b.IndexedFaceSet.prototype.SetNFloatAttributeIndex=function(a){};b.IndexedFaceSet.prototype.SetNIntAttributeIndex=function(a){};b.IndexedFaceSet.prototype.SetFloatAttributePerVertex=function(a){};b.IndexedFaceSet.prototype.SetIntAttributePerVertex=function(a){};b.IndexedFaceSet.prototype.SetNCoord=function(a){this.m_nCoord=a};b.IndexedFaceSet.prototype.SetNNormal=function(a){this.m_nNormal=a};b.IndexedFaceSet.prototype.SetNumFloatAttributes=function(a){this.m_numFloatAttributes=a};b.IndexedFaceSet.prototype.SetNumIntAttributes=
function(a){this.m_numIntAttributes=a};b.IndexedFaceSet.prototype.SetCreaseAngle=function(a){this.m_creaseAngle=a};b.IndexedFaceSet.prototype.SetCCW=function(a){this.m_ccw=a};b.IndexedFaceSet.prototype.SetSolid=function(a){this.m_solid=a};b.IndexedFaceSet.prototype.SetConvex=function(a){this.m_convex=a};b.IndexedFaceSet.prototype.SetIsTriangularMesh=function(a){this.m_isTriangularMesh=a};b.IndexedFaceSet.prototype.SetCoordMin=function(a,b){this.m_coordMin[a]=b};b.IndexedFaceSet.prototype.SetCoordMax=
function(a,b){this.m_coordMax[a]=b};b.IndexedFaceSet.prototype.SetNormalMin=function(a,b){this.m_normalMin[a]=b};b.IndexedFaceSet.prototype.SetNormalMax=function(a,b){this.m_normalMax[a]=b};b.IndexedFaceSet.prototype.SetNFloatAttribute=function(a,b){this.m_nFloatAttribute[a]=b};b.IndexedFaceSet.prototype.SetNIntAttribute=function(a,b){this.m_nIntAttribute[a]=b};b.IndexedFaceSet.prototype.SetFloatAttributeDim=function(a,b){this.m_dimFloatAttribute[a]=b};b.IndexedFaceSet.prototype.SetIntAttributeDim=
function(a,b){this.m_dimIntAttribute[a]=b};b.IndexedFaceSet.prototype.SetFloatAttributeType=function(a,b){this.m_typeFloatAttribute[a]=b};b.IndexedFaceSet.prototype.SetIntAttributeType=function(a,b){this.m_typeIntAttribute[a]=b};b.IndexedFaceSet.prototype.SetFloatAttributeMin=function(a,b,c){this.m_minFloatAttribute[a*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+b]=c};b.IndexedFaceSet.prototype.SetFloatAttributeMax=function(a,b,c){this.m_maxFloatAttribute[a*g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+b]=c};b.IndexedFaceSet.prototype.SetCoordIndex=
function(a){this.m_coordIndex=a};b.IndexedFaceSet.prototype.SetCoord=function(a){this.m_coord=a};b.IndexedFaceSet.prototype.SetNormal=function(a){this.m_normal=a};b.IndexedFaceSet.prototype.SetFloatAttribute=function(a,b){this.m_floatAttribute[a]=b};b.IndexedFaceSet.prototype.SetIntAttribute=function(a,b){this.m_intAttribute[a]=b};b.SC3DMCEncodeParams=function(){var a;this.m_numIntAttributes=this.m_numFloatAttributes=0;this.m_floatAttributeQuantBits=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);
this.m_floatAttributePredMode=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES);this.m_intAttributePredMode=new Uint32Array(g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES);this.m_encodeMode=g.O3DGC_SC3DMC_ENCODE_MODE_TFAN;this.m_streamTypeMode=g.O3DGC_STREAM_TYPE_ASCII;this.m_coordQuantBits=14;this.m_normalQuantBits=8;this.m_coordPredMode=g.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;this.m_normalPredMode=g.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION;for(a=0;a<g.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES;++a)this.m_floatAttributePredMode[a]=
g.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;for(a=0;a<g.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES;++a)this.m_intAttributePredMode[a]=g.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION};b.SC3DMCEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode};b.SC3DMCEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode};b.SC3DMCEncodeParams.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes};b.SC3DMCEncodeParams.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes};
b.SC3DMCEncodeParams.prototype.GetCoordQuantBits=function(){return this.m_coordQuantBits};b.SC3DMCEncodeParams.prototype.GetNormalQuantBits=function(){return this.m_normalQuantBits};b.SC3DMCEncodeParams.prototype.GetFloatAttributeQuantBits=function(a){return this.m_floatAttributeQuantBits[a]};b.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode};b.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode};b.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=
function(a){return this.m_floatAttributePredMode[a]};b.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(a){return this.m_intAttributePredMode[a]};b.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode};b.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode};b.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(a){return this.m_floatAttributePredMode[a]};b.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=
function(a){return this.m_intAttributePredMode[a]};b.SC3DMCEncodeParams.prototype.SetStreamType=function(a){this.m_streamTypeMode=a};b.SC3DMCEncodeParams.prototype.SetEncodeMode=function(a){this.m_encodeMode=a};b.SC3DMCEncodeParams.prototype.SetNumFloatAttributes=function(a){this.m_numFloatAttributes=a};b.SC3DMCEncodeParams.prototype.SetNumIntAttributes=function(a){this.m_numIntAttributes=a};b.SC3DMCEncodeParams.prototype.SetCoordQuantBits=function(a){this.m_coordQuantBits=a};b.SC3DMCEncodeParams.prototype.SetNormalQuantBits=
function(a){this.m_normalQuantBits=a};b.SC3DMCEncodeParams.prototype.SetFloatAttributeQuantBits=function(a,b){this.m_floatAttributeQuantBits[a]=b};b.SC3DMCEncodeParams.prototype.SetCoordPredMode=function(a){this.m_coordPredMode=a};b.SC3DMCEncodeParams.prototype.SetNormalPredMode=function(a){this.m_normalPredMode=a};b.SC3DMCEncodeParams.prototype.SetFloatAttributePredMode=function(a,b){this.m_floatAttributePredMode[a]=b};b.SC3DMCEncodeParams.prototype.SetIntAttributePredMode=function(a,b){this.m_intAttributePredMode[a]=
b};b.AdjacencyInfo=function(){this.m_numElements=this.m_numNeighborsSize=this.m_neighborsSize=0;this.m_neighbors={};this.m_numNeighbors={}};b.AdjacencyInfo.prototype.Allocate=function(a,d){this.m_numElements=a;d>this.m_neighborsSize&&(this.m_neighborsSize=d,this.m_neighbors=new Int32Array(this.m_neighborsSize));a>this.m_numNeighborsSize&&(this.m_numNeighborsSize=a,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize));return b.O3DGC_OK};b.AdjacencyInfo.prototype.AllocateNumNeighborsArray=function(a){a>
this.m_numNeighborsSize&&(this.m_numNeighborsSize=a,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize));this.m_numElements=a;return b.O3DGC_OK};b.AdjacencyInfo.prototype.AllocateNeighborsArray=function(){var a;for(a=1;a<this.m_numElements;++a)this.m_numNeighbors[a]+=this.m_numNeighbors[a-1];this.m_numNeighbors[this.m_numElements-1]>this.m_neighborsSize&&(this.m_neighborsSize=this.m_numNeighbors[this.m_numElements-1],this.m_neighbors=new Int32Array(this.m_neighborsSize));return b.O3DGC_OK};
b.AdjacencyInfo.prototype.ClearNumNeighborsArray=function(){var a;for(a=0;a<this.m_numElements;++a)this.m_numNeighbors[a]=0;return b.O3DGC_OK};b.AdjacencyInfo.prototype.ClearNeighborsArray=function(){var a;for(a=0;a<this.m_neighborsSize;++a)this.m_neighbors[a]=-1;return b.O3DGC_OK};b.AdjacencyInfo.prototype.Begin=function(a){return 0<a?this.m_numNeighbors[a-1]:0};b.AdjacencyInfo.prototype.End=function(a){return this.m_numNeighbors[a]};b.AdjacencyInfo.prototype.AddNeighbor=function(a,d){var c,e;c=
this.Begin(a);for(e=this.End(a);c<e;++c)if(-1===this.m_neighbors[c])return this.m_neighbors[c]=d,b.O3DGC_OK;return b.O3DGC_ERROR_BUFFER_FULL};b.AdjacencyInfo.prototype.GetNeighbor=function(a){return this.m_neighbors[a]};b.AdjacencyInfo.prototype.GetNumNeighbors=function(a){return this.End(a)-this.Begin(a)};b.AdjacencyInfo.prototype.GetNumNeighborsBuffer=function(){return this.m_numNeighbors};b.AdjacencyInfo.prototype.GetNeighborsBuffer=function(){return this.m_neighbors};b.Vector=function(){this.m_data=
{};this.m_size=this.m_allocated=0};b.Vector.prototype.Clear=function(){this.m_size=0};b.Vector.prototype.Get=function(a){return this.m_data[a]};b.Vector.prototype.GetAllocatedSize=function(){return this.m_allocated};b.Vector.prototype.GetSize=function(){return this.m_size};b.Vector.prototype.GetBuffer=function(){return this.m_data};b.Vector.prototype.SetSize=function(a){this.m_size=a};b.Vector.prototype.Allocate=function(a){var b;if(a>this.m_allocated){this.m_allocated=a;b=new Int32Array(this.m_allocated);
if(0<this.m_size)for(a=0;a<this.m_size;++a)b[a]=this.m_data[a];this.m_data=b}};b.Vector.prototype.PushBack=function(a){var b,c;if(this.m_size===this.m_allocated){this.m_allocated*=2;this.m_allocated<g.O3DGC_DEFAULT_VECTOR_SIZE&&(this.m_allocated=g.O3DGC_DEFAULT_VECTOR_SIZE);c=new Int32Array(this.m_allocated);if(0<this.m_size)for(b=0;b<this.m_size;++b)c[b]=this.m_data[b];this.m_data=c}this.m_data[this.m_size++]=a};b.CompressedTriangleFans=function(){this.m_numTFANs=new b.Vector;this.m_degrees=new b.Vector;
this.m_configs=new b.Vector;this.m_operations=new b.Vector;this.m_indices=new b.Vector;this.m_trianglesOrder=new b.Vector;this.m_streamType=g.O3DGC_STREAM_TYPE_UNKOWN};b.CompressedTriangleFans.prototype.GetStreamType=function(){return this.m_streamType};b.CompressedTriangleFans.prototype.SetStreamType=function(a){this.m_streamType=a};b.CompressedTriangleFans.prototype.Clear=function(){this.m_numTFANs.Clear();this.m_degrees.Clear();this.m_configs.Clear();this.m_operations.Clear();this.m_indices.Clear();
return b.O3DGC_OK};b.CompressedTriangleFans.prototype.Allocate=function(a,d){this.m_numTFANs.Allocate(a);this.m_degrees.Allocate(2*a);this.m_configs.Allocate(2*a);this.m_operations.Allocate(2*a);this.m_indices.Allocate(2*a);this.m_trianglesOrder.Allocate(d);this.Clear();return b.O3DGC_OK};b.CompressedTriangleFans.prototype.PushNumTFans=function(a){this.m_numTFANs.PushBack(a)};b.CompressedTriangleFans.prototype.ReadNumTFans=function(a){return this.m_numTFANs.Get(a.m_count++)};b.CompressedTriangleFans.prototype.PushDegree=
function(a){this.m_degrees.PushBack(a)};b.CompressedTriangleFans.prototype.ReadDegree=function(a){return this.m_degrees.Get(a.m_count++)};b.CompressedTriangleFans.prototype.PushConfig=function(a){this.m_configs.PushBack(a)};b.CompressedTriangleFans.prototype.ReadConfig=function(a){return this.m_configs.Get(a.m_count++)};b.CompressedTriangleFans.prototype.PushOperation=function(a){this.m_operations.PushBack(a)};b.CompressedTriangleFans.prototype.ReadOperation=function(a){return this.m_operations.Get(a.m_count++)};
b.CompressedTriangleFans.prototype.PushIndex=function(a){this.m_indices.PushBack(a)};b.CompressedTriangleFans.prototype.ReadIndex=function(a){return this.m_indices.Get(a.m_count++)};b.CompressedTriangleFans.prototype.PushTriangleIndex=function(a){this.m_trianglesOrder.PushBack(0>a?-1-2*a:2*a)};b.CompressedTriangleFans.prototype.ReadTriangleIndex=function(a){return I(this.m_trianglesOrder.Get(a.m_count++))};b.CompressedTriangleFans.prototype.LoadUIntData=function(a,d,c){var e,f;d.ReadUInt32ASCII(c);
e=d.ReadUInt32ASCII(c);a.Allocate(e);a.Clear();for(f=0;f<e;++f)a.PushBack(d.ReadUIntASCII(c));return b.O3DGC_OK};b.CompressedTriangleFans.prototype.LoadIntData=function(a,d,c){var e,f;d.ReadUInt32ASCII(c);e=d.ReadUInt32ASCII(c);a.Allocate(e);a.Clear();for(f=0;f<e;++f)a.PushBack(d.ReadIntASCII(c));return b.O3DGC_OK};b.CompressedTriangleFans.prototype.LoadBinData=function(a,d,c){var e,f,s,m;d.ReadUInt32ASCII(c);e=d.ReadUInt32ASCII(c);a.Allocate(e*g.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0);a.Clear();for(s=
0;s<e;)for(f=d.ReadUCharASCII(c),m=0;m<g.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0;++m)a.PushBack(f&1),f>>>=1,++s;return b.O3DGC_OK};b.CompressedTriangleFans.prototype.LoadUIntAC=function(a,d,c,e){var f,g,m;f=c.ReadUInt32Bin(e)-12;g=c.ReadUInt32Bin(e);if(0===g)return b.O3DGC_OK;m=c.ReadUInt32Bin(e);c=c.GetBuffer(e,f);e.m_count+=f;a.Allocate(g);e=new b.ArithmeticDecoder;e.SetBuffer(f,c);e.StartDecoder();f=new b.AdaptiveDataModel;f.SetAlphabet(d+1);for(d=0;d<g;++d)a.PushBack(e.DecodeAdaptiveDataModel(f)+
m);return b.O3DGC_OK};b.CompressedTriangleFans.prototype.LoadIntACEGC=function(a,d,c,e){var f,s,m,l,h,k;f=c.ReadUInt32Bin(e)-12;s=c.ReadUInt32Bin(e);if(0===s)return b.O3DGC_OK;m=c.ReadUInt32Bin(e)-g.O3DGC_MAX_LONG;c=c.GetBuffer(e,f);e.m_count+=f;a.Allocate(s);e=new b.ArithmeticDecoder;e.SetBuffer(f,c);e.StartDecoder();f=new b.AdaptiveDataModel;f.SetAlphabet(d+2);c=new b.StaticBitModel;l=new b.AdaptiveBitModel;for(k=0;k<s;++k)h=e.DecodeAdaptiveDataModel(f),h===d&&(h+=e.ExpGolombDecode(0,c,l)),a.PushBack(h+
m);return b.O3DGC_OK};b.CompressedTriangleFans.prototype.LoadBinAC=function(a,d,c){var e,f;e=d.ReadUInt32Bin(c)-8;f=d.ReadUInt32Bin(c);if(0===f)return b.O3DGC_OK;d=d.GetBuffer(c,e);c.m_count+=e;a.Allocate(f);c=new b.ArithmeticDecoder;c.SetBuffer(e,d);c.StartDecoder();e=new b.AdaptiveBitModel;for(d=0;d<f;++d)a.PushBack(c.DecodeAdaptiveBitModel(e));return b.O3DGC_OK};b.CompressedTriangleFans.prototype.Load=function(a,d,c,e){e===g.O3DGC_STREAM_TYPE_ASCII?(this.LoadUIntData(this.m_numTFANs,a,d),this.LoadUIntData(this.m_degrees,
a,d),this.LoadUIntData(this.m_configs,a,d),this.LoadBinData(this.m_operations,a,d),this.LoadIntData(this.m_indices,a,d),c&&this.LoadUIntData(this.m_trianglesOrder,a,d)):(this.LoadIntACEGC(this.m_numTFANs,4,a,d),this.LoadIntACEGC(this.m_degrees,16,a,d),this.LoadUIntAC(this.m_configs,10,a,d),this.LoadBinAC(this.m_operations,a,d),this.LoadIntACEGC(this.m_indices,8,a,d),c&&this.LoadIntACEGC(this.m_trianglesOrder,16,a,d));return b.O3DGC_OK};b.TriangleFans=function(){this.m_numVertices=this.m_numTFANs=
this.m_sizeTFANAllocatedSize=this.m_verticesAllocatedSize=0;this.m_sizeTFAN={};this.m_vertices={}};b.TriangleFans.prototype.Allocate=function(a,d){this.m_numVertices=this.m_numTFANs=0;this.m_verticesAllocatedSize<d&&(this.m_verticesAllocatedSize=d,this.m_vertices=new Int32Array(this.m_verticesAllocatedSize));this.m_sizeTFANAllocatedSize<a&&(this.m_sizeTFANAllocatedSize=a,this.m_sizeTFAN=new Int32Array(this.m_sizeTFANAllocatedSize));return b.O3DGC_OK};b.TriangleFans.prototype.Clear=function(){this.m_numVertices=
this.m_numTFANs=0;return b.O3DGC_OK};b.TriangleFans.prototype.AddVertex=function(a){var d,c;++this.m_numVertices;if(this.m_numVertices>this.m_verticesAllocatedSize){this.m_verticesAllocatedSize*=2;c=new Int32Array(this.m_verticesAllocatedSize);for(d=0;d<this.m_numVertices;++d)c[d]=this.m_vertices[d];this.m_vertices=c}this.m_vertices[this.m_numVertices-1]=a;++this.m_sizeTFAN[this.m_numTFANs-1];return b.O3DGC_OK};b.TriangleFans.prototype.AddTFAN=function(){var a,d;++this.m_numTFANs;if(this.m_numTFANs>
this.m_sizeTFANAllocatedSize){this.m_sizeTFANAllocatedSize*=2;d=new Int32Array(this.m_sizeTFANAllocatedSize);for(a=0;a<this.m_numTFANs;++a)d[a]=this.m_sizeTFAN[a];this.m_sizeTFAN=d}this.m_sizeTFAN[this.m_numTFANs-1]=1<this.m_numTFANs?this.m_sizeTFAN[this.m_numTFANs-2]:0;return b.O3DGC_OK};b.TriangleFans.prototype.Begin=function(a){return 0<a?this.m_sizeTFAN[a-1]:0};b.TriangleFans.prototype.End=function(a){return this.m_sizeTFAN[a]};b.TriangleFans.prototype.GetVertex=function(a){return this.m_vertices[a]};
b.TriangleFans.prototype.GetTFANSize=function(a){return this.End(a)-this.Begin(a)};b.TriangleFans.prototype.GetNumTFANs=function(){return this.m_numTFANs};b.TriangleFans.prototype.GetNumVertices=function(){return this.m_numVertices};b.TriangleListDecoder=function(){this.m_itNumTFans=new b.Iterator;this.m_itDegree=new b.Iterator;this.m_itConfig=new b.Iterator;this.m_itOperation=new b.Iterator;this.m_itIndex=new b.Iterator;this.m_numVisitedVertices=this.m_numConqueredTriangles=this.m_triangleCount=
this.m_vertexCount=this.m_tempTrianglesSize=this.m_numVertices=this.m_numTriangles=this.m_maxNumTriangles=this.m_maxNumVertices=0;this.m_triangles={};this.m_tempTriangles={};this.m_visitedVertices={};this.m_visitedVerticesValence={};this.m_vertexToTriangle=new b.AdjacencyInfo;this.m_ctfans=new b.CompressedTriangleFans;this.m_tfans=new b.TriangleFans;this.m_streamType=g.O3DGC_STREAM_TYPE_ASCII;this.m_decodeVerticesOrder=this.m_decodeTrianglesOrder=!1;this.m_processConfig={0:function(a,b){var c;a.m_tfans.AddVertex(a.m_visitedVertices[0]);
for(c=1;c<b-1;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++);a.m_tfans.AddVertex(a.m_visitedVertices[1])},1:function(a,b,c){var e,f;a.m_tfans.AddVertex(a.m_visitedVertices[0]);for(e=1;e<b-1;++e)f=a.m_ctfans.ReadOperation(a.m_itOperation),1===f?(f=a.m_ctfans.ReadIndex(a.m_itIndex),0>f?a.m_tfans.AddVertex(a.m_visitedVertices[-f-1]):a.m_tfans.AddVertex(f+c)):(a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++));
a.m_tfans.AddVertex(a.m_visitedVertices[1])},2:function(a,b){var c;for(c=0;c<b-1;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++);a.m_tfans.AddVertex(a.m_visitedVertices[0])},3:function(a,b){var c;for(c=0;c<b-1;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++);a.m_tfans.AddVertex(a.m_visitedVertices[1])},4:function(a,b){var c;a.m_tfans.AddVertex(a.m_visitedVertices[0]);for(c=1;c<b;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=
a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++)},5:function(a,b){var c;a.m_tfans.AddVertex(a.m_visitedVertices[1]);for(c=1;c<b;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++)},6:function(a,b){var c;for(c=0;c<b;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++)},7:function(a,b){var c;a.m_tfans.AddVertex(a.m_visitedVertices[1]);for(c=1;c<b-1;++c)a.m_visitedVertices[a.m_numVisitedVertices++]=
a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++);a.m_tfans.AddVertex(a.m_visitedVertices[0])},8:function(a,b,c){var e,f;a.m_tfans.AddVertex(a.m_visitedVertices[1]);for(e=1;e<b-1;++e)f=a.m_ctfans.ReadOperation(a.m_itOperation),1===f?(f=a.m_ctfans.ReadIndex(a.m_itIndex),0>f?a.m_tfans.AddVertex(a.m_visitedVertices[-f-1]):a.m_tfans.AddVertex(f+c)):(a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++));a.m_tfans.AddVertex(a.m_visitedVertices[0])},9:function(a,
b,c){var e,f;for(e=0;e<b;++e)f=a.m_ctfans.ReadOperation(a.m_itOperation),1===f?(f=a.m_ctfans.ReadIndex(a.m_itIndex),0>f?a.m_tfans.AddVertex(a.m_visitedVertices[-f-1]):a.m_tfans.AddVertex(f+c)):(a.m_visitedVertices[a.m_numVisitedVertices++]=a.m_vertexCount,a.m_tfans.AddVertex(a.m_vertexCount++))}}};b.TriangleListDecoder.prototype.GetStreamType=function(){return this.m_streamType};b.TriangleListDecoder.prototype.GetReorderTriangles=function(){return this.m_decodeTrianglesOrder};b.TriangleListDecoder.prototype.GetReorderVertices=
function(){return this.m_decodeVerticesOrder};b.TriangleListDecoder.prototype.SetStreamType=function(a){this.m_streamType=a};b.TriangleListDecoder.prototype.GetVertexToTriangle=function(){return this.m_vertexToTriangle};b.TriangleListDecoder.prototype.Reorder=function(){var a,d,c,e,f,g,m;if(this.m_decodeTrianglesOrder)for(a=this.m_triangles,d=this.m_numTriangles,c=this.m_ctfans.m_trianglesOrder.m_data,g=this.m_tempTriangles,g.set(a),m=f=e=0;m<d;++m)f=I(c[e++])+f,a[3*f]=g[3*m],a[3*f+1]=g[3*m+1],a[3*
f+2]=g[3*m+2],f+=1;return b.O3DGC_OK};b.TriangleListDecoder.prototype.CompueLocalConnectivityInfo=function(a){var d,c,e,f,g,m,l,h,k,n,p,q,w,t;d=this.m_visitedVertices;c=this.m_visitedVerticesValence;e=this.m_triangles;f=this.m_vertexToTriangle;g=f.Begin(a);m=f.End(a);for(q=k=l=0;0<=q&&g<m;++g)if(q=f.GetNeighbor(g),0<=q)for(++l,w=3*q,p=0;3>p;++p)if(t=e[w+p],t>a){h=!1;for(n=0;n<k;++n)if(t===d[n]){c[n]++;h=!0;break}else if(t<d[n]){++k;for(h=k-1;h>n;--h)d[h]=d[h-1],c[h]=c[h-1];d[n]=t;c[n]=1;h=!0;break}h||
(d[k]=t,c[k]=1,k++)}if(2<k)for(e=1;e<k;++e)if(1===c[e])for(f=e;0<f&&c[f]<c[f-1];)a=c[f],c[f]=c[f-1],c[f-1]=a,a=d[f],d[f]=d[f-1],d[f-1]=a,--f;this.m_numConqueredTriangles=l;this.m_numVisitedVertices=k;return b.O3DGC_OK};b.TriangleListDecoder.prototype.DecompressTFAN=function(a){var d,c,e,f,g,m,l,h,k,n,p,q,w,t,z,r;d=this.m_vertexToTriangle;c=this.m_triangles;e=this.m_itDegree;f=this.m_itConfig;g=this.m_tfans;l=this.m_processConfig;h=this.m_ctfans;k=this.m_triangleCount;n=this.m_numConqueredTriangles;
m=h.ReadNumTFans(this.m_itNumTFans);if(0<m)for(z=0;z<m;++z)for(g.AddTFAN(),p=h.ReadDegree(e)+2-n,q=h.ReadConfig(f),w=g.GetNumVertices(),g.AddVertex(a),l[q](this,p,a),p=g.GetNumVertices(),q=g.GetVertex(w+1),r=w+2;r<p;++r)w=g.GetVertex(r),t=3*k,c[t++]=a,c[t++]=q,c[t]=w,d.AddNeighbor(a,k),d.AddNeighbor(q,k),d.AddNeighbor(w,k),q=w,k++;this.m_triangleCount=k;return b.O3DGC_OK};b.TriangleListDecoder.prototype.Decompress=function(){var a;for(a=0;a<this.m_numVertices;++a)a===this.m_vertexCount&&this.m_vertexCount++,
this.CompueLocalConnectivityInfo(a),this.DecompressTFAN(a);return b.O3DGC_OK};b.TriangleListDecoder.prototype.Init=function(a,d,c,e){this.m_numTriangles=d;this.m_numVertices=c;this.m_triangles=a;this.m_triangleCount=this.m_vertexCount=0;this.m_itNumTFans.m_count=0;this.m_itDegree.m_count=0;this.m_itConfig.m_count=0;this.m_itOperation.m_count=0;this.m_itIndex.m_count=0;this.m_numVertices>this.m_maxNumVertices&&(this.m_maxNumVertices=this.m_numVertices,this.m_visitedVerticesValence=new Int32Array(this.m_numVertices),
this.m_visitedVertices=new Int32Array(this.m_numVertices));this.m_decodeTrianglesOrder&&this.m_tempTrianglesSize<this.m_numTriangles&&(this.m_tempTrianglesSize=this.m_numTriangles,this.m_tempTriangles=new Int32Array(3*this.m_tempTrianglesSize));this.m_ctfans.SetStreamType(this.m_streamType);this.m_ctfans.Allocate(this.m_numVertices,this.m_numTriangles);this.m_tfans.Allocate(2*this.m_numVertices,8*this.m_numVertices);this.m_vertexToTriangle.AllocateNumNeighborsArray(c);d=this.m_vertexToTriangle.GetNumNeighborsBuffer();
for(a=0;a<c;++a)d[a]=e;this.m_vertexToTriangle.AllocateNeighborsArray();this.m_vertexToTriangle.ClearNeighborsArray();return b.O3DGC_OK};b.TriangleListDecoder.prototype.Decode=function(a,d,c,e,f){var g;g=e.ReadUChar(f,this.m_streamType);this.m_decodeTrianglesOrder=0!==(g&2);if(this.m_decodeVerticesOrder=0!==(g&1))return b.O3DGC_ERROR_NON_SUPPORTED_FEATURE;g=e.ReadUInt32(f,this.m_streamType);this.Init(a,d,c,g);this.m_ctfans.Load(e,f,this.m_decodeTrianglesOrder,this.m_streamType);this.Decompress();
return b.O3DGC_OK};b.SC3DMCDecoder=function(){var a;this.m_iterator=new b.Iterator;this.m_streamSize=0;this.m_params=new b.SC3DMCEncodeParams;this.m_triangleListDecoder=new b.TriangleListDecoder;this.m_quantFloatArray={};this.m_orientation={};this.m_normals={};this.m_orientationSize=this.m_normalsSize=this.m_quantFloatArraySize=0;this.m_stats=new b.SC3DMCStats;this.m_streamType=g.O3DGC_STREAM_TYPE_UNKOWN;this.m_neighbors=[];this.m_idelta=new Float32Array(g.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES);this.m_minNormal=
new Float32Array(2);this.m_maxNormal=new Float32Array(2);this.m_minNormal[0]=this.m_minNormal[1]=-2;this.m_maxNormal[0]=this.m_maxNormal[1]=2;for(a=0;a<g.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS;++a)this.m_neighbors[a]=new b.SC3DMCTriplet};b.SC3DMCDecoder.prototype.GetStats=function(){return this.m_stats};b.SC3DMCDecoder.prototype.DecodeHeader=function(a,d){var c,e,f;c=this.m_iterator.m_count;e=d.ReadUInt32(this.m_iterator,g.O3DGC_STREAM_TYPE_BINARY);if(e!==g.O3DGC_SC3DMC_START_CODE){this.m_iterator.m_count=
c;e=d.ReadUInt32(this.m_iterator,g.O3DGC_STREAM_TYPE_ASCII);if(e!==g.O3DGC_SC3DMC_START_CODE)return b.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=g.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=g.O3DGC_STREAM_TYPE_BINARY;this.m_streamSize=d.ReadUInt32(this.m_iterator,this.m_streamType);this.m_params.SetEncodeMode(d.ReadUChar(this.m_iterator,this.m_streamType));a.SetCreaseAngle(d.ReadFloat32(this.m_iterator,this.m_streamType));c=d.ReadUChar(this.m_iterator,this.m_streamType);a.SetCCW(1===(c&1));
a.SetSolid(1===(c&2));a.SetConvex(1===(c&4));a.SetIsTriangularMesh(1===(c&8));a.SetNCoord(d.ReadUInt32(this.m_iterator,this.m_streamType));a.SetNNormal(d.ReadUInt32(this.m_iterator,this.m_streamType));a.SetNumFloatAttributes(d.ReadUInt32(this.m_iterator,this.m_streamType));a.SetNumIntAttributes(d.ReadUInt32(this.m_iterator,this.m_streamType));if(0<a.GetNCoord()){a.SetNCoordIndex(d.ReadUInt32(this.m_iterator,this.m_streamType));for(c=0;3>c;++c)a.SetCoordMin(c,d.ReadFloat32(this.m_iterator,this.m_streamType)),
a.SetCoordMax(c,d.ReadFloat32(this.m_iterator,this.m_streamType));this.m_params.SetCoordQuantBits(d.ReadUChar(this.m_iterator,this.m_streamType))}if(0<a.GetNNormal()){a.SetNNormalIndex(d.ReadUInt32(this.m_iterator,this.m_streamType));for(c=0;3>c;++c)a.SetNormalMin(c,d.ReadFloat32(this.m_iterator,this.m_streamType)),a.SetNormalMax(c,d.ReadFloat32(this.m_iterator,this.m_streamType));a.SetNormalPerVertex(1===d.ReadUChar(this.m_iterator,this.m_streamType));this.m_params.SetNormalQuantBits(d.ReadUChar(this.m_iterator,
this.m_streamType))}for(e=0;e<a.GetNumFloatAttributes();++e)if(a.SetNFloatAttribute(e,d.ReadUInt32(this.m_iterator,this.m_streamType)),0<a.GetNFloatAttribute(e)){a.SetNFloatAttributeIndex(e,d.ReadUInt32(this.m_iterator,this.m_streamType));f=d.ReadUChar(this.m_iterator,this.m_streamType);a.SetFloatAttributeDim(e,f);for(c=0;c<f;++c)a.SetFloatAttributeMin(e,c,d.ReadFloat32(this.m_iterator,this.m_streamType)),a.SetFloatAttributeMax(e,c,d.ReadFloat32(this.m_iterator,this.m_streamType));a.SetFloatAttributePerVertex(e,
1===d.ReadUChar(this.m_iterator,this.m_streamType));a.SetFloatAttributeType(e,d.ReadUChar(this.m_iterator,this.m_streamType));this.m_params.SetFloatAttributeQuantBits(e,d.ReadUChar(this.m_iterator,this.m_streamType))}for(e=0;e<a.GetNumIntAttributes();++e)a.SetNIntAttribute(e,d.ReadUInt32(this.m_iterator,this.m_streamType)),0<a.GetNIntAttribute(e)&&(a.SetNIntAttributeIndex(e,d.ReadUInt32(this.m_iterator,this.m_streamType)),a.SetIntAttributeDim(e,d.ReadUChar(this.m_iterator,this.m_streamType)),a.SetIntAttributePerVertex(e,
1===d.ReadUChar(this.m_iterator,this.m_streamType)),a.SetIntAttributeType(e,d.ReadUChar(this.m_iterator,this.m_streamType)));return b.O3DGC_OK};b.SC3DMCDecoder.prototype.DecodeIntArrayBinary=function(a,d,c,e,f,s,m){var l,h,k,n,p,q,w,t,z,r,v,x,E,A,D,B,C,y;p=this.m_iterator;q=this.m_streamType;w=new b.ArithmeticDecoder;t=new b.StaticBitModel;z=new b.AdaptiveBitModel;r=new b.AdaptiveDataModel;r.SetAlphabet(g.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS+1);v=this.m_triangleListDecoder.GetVertexToTriangle();
x=v.m_neighbors;f=f.GetCoordIndex();E=p.m_count;h=m.ReadUInt32(p,q);A=m.ReadUChar(p,q);q=A>>>4&7;s.m_value=A&7;h-=p.m_count-E;E=new b.Iterator;E.m_count=p.m_count+h;new b.SC3DMCTriplet(-1,-1,-1);if(q!==g.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return b.O3DGC_ERROR_CORRUPTED_STREAM;m=m.GetBuffer(p,h);p.m_count+=h;w.SetBuffer(h,m);w.StartDecoder();q=w.ExpGolombDecode(0,t,z);A=w.ExpGolombDecode(0,t,z);D=new b.AdaptiveDataModel;D.SetAlphabet(A+2);B=this.m_neighbors;C=new b.NumberRef;h=s.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION;
for(y=0;y<d;++y){m=y*e;C.m_value=0;if(0<v.GetNumNeighbors(y)&&h)for(k=v.Begin(y),l=v.End(y);k<l;++k){n=x[k];if(0>n)break;K(f,n,y,C,B)}if(1<C.m_value)for(l=B[w.DecodeAdaptiveDataModel(r)],l=l.m_c*e,k=0;k<c;++k)for(k=0;k<c;++k)n=w.DecodeIntACEGC(D,t,z,q,A),a[m+k]=n+a[l+k];else if(0<y&&s.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION)for(k=0;k<c;++k)n=w.DecodeIntACEGC(D,t,z,q,A),a[m+k]=n+a[(y-1)*e+k];else for(k=0;k<c;++k)n=w.DecodeUIntACEGC(D,t,z,q,A),a[m+k]=n}p.m_count=E.m_count;return b.O3DGC_OK};b.SC3DMCDecoder.prototype.DecodeIntArrayASCII=
function(a,d,c,e,f,s,m){var l,h,k,n,p,q,w,t,z,r,v,x;n=this.m_iterator;l=this.m_streamType;q=this.m_triangleListDecoder.GetVertexToTriangle();w=q.m_neighbors;f=f.GetCoordIndex();t=n.m_count;k=m.ReadUInt32(n,l);z=m.ReadUChar(n,l);r=z>>>4&7;s.m_value=z&7;k-=n.m_count-t;t=new b.Iterator;t.m_count=n.m_count+k;new b.SC3DMCTriplet(-1,-1,-1);if(r!==g.O3DGC_SC3DMC_BINARIZATION_ASCII)return b.O3DGC_ERROR_CORRUPTED_STREAM;m.ReadUInt32(t,l);r=this.m_neighbors;z=new b.NumberRef;k=s.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION;
for(v=0;v<d;++v){z.m_value=0;l=v*e;if(0<q.GetNumNeighbors(v)&&k)for(p=q.Begin(v),h=q.End(v);p<h;++p){x=w[p];if(0>x)break;K(f,x,v,z,r)}if(1<z.m_value)for(h=r[m.ReadUCharASCII(t)],h=h.m_c*e,x=0;x<c;++x)for(x=0;x<c;++x)p=m.ReadIntASCII(n),a[l+x]=p+a[h+x];else if(0<v&&s.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION)for(x=0;x<c;++x)p=m.ReadIntASCII(n),a[l+x]=p+a[(v-1)*e+x];else for(x=0;x<c;++x)p=m.ReadUIntASCII(n),a[l+x]=p}n.m_count=t.m_count;return b.O3DGC_OK};b.SC3DMCDecoder.prototype.DecodeIntArray=function(a,
b,c,e,f,s,m){return this.m_streamType===g.O3DGC_STREAM_TYPE_ASCII?this.DecodeIntArrayASCII(a,b,c,e,f,s,m):this.DecodeIntArrayBinary(a,b,c,e,f,s,m)};b.SC3DMCDecoder.prototype.ProcessNormals=function(a){var d,c,e,f,g,m,l,h;e=a.GetNNormal();f=3*a.GetNNormal();this.m_normalsSize<f&&(this.m_normalsSize=f,this.m_normals=new Float32Array(this.m_normalsSize));f=this.m_normals;g=this.m_quantFloatArray;m=this.m_orientation;l=a.GetCoordIndex();a=a.GetNCoordIndex();var k,n,p,q;c=new b.Vec3;d=new b.Vec3;h=new b.Vec3;
p=3*e;for(n=0;n<p;++n)f[n]=0;for(n=0;n<a;++n)k=3*n,p=3*l[k],q=3*l[k+1],k=3*l[k+2],d.m_x=g[q]-g[p],d.m_y=g[q+1]-g[p+1],d.m_z=g[q+2]-g[p+2],h.m_x=g[k]-g[p],h.m_y=g[k+1]-g[p+1],h.m_z=g[k+2]-g[p+2],c.m_x=d.m_y*h.m_z-d.m_z*h.m_y,c.m_y=d.m_z*h.m_x-d.m_x*h.m_z,c.m_z=d.m_x*h.m_y-d.m_y*h.m_x,f[p]+=c.m_x,f[p+1]+=c.m_y,f[p+2]+=c.m_z,f[q]+=c.m_x,f[q+1]+=c.m_y,f[q+2]+=c.m_z,f[k]+=c.m_x,f[k+1]+=c.m_y,f[k+2]+=c.m_z;g=new b.Vec3;l=new b.Vec3;for(a=0;a<e;++a)d=3*a,g.m_x=f[d],g.m_y=f[d+1],g.m_z=f[d+2],d=Math.sqrt(g.m_x*
g.m_x+g.m_y*g.m_y+g.m_z*g.m_z),0===d&&(d=1),h=g,c=l,q=p=n=void 0,n=Math.abs(h.m_x),p=Math.abs(h.m_y),q=Math.abs(h.m_z),q>=n&&q>=p?0<=h.m_z?(c.m_z=0,c.m_x=h.m_x,c.m_y=h.m_y):(c.m_z=1,c.m_x=-h.m_x,c.m_y=-h.m_y):p>=n&&p>=q?0<=h.m_y?(c.m_z=2,c.m_x=h.m_z,c.m_y=h.m_x):(c.m_z=3,c.m_x=-h.m_z,c.m_y=-h.m_x):0<=h.m_x?(c.m_z=4,c.m_x=h.m_y,c.m_y=h.m_z):(c.m_z=5,c.m_x=-h.m_y,c.m_y=-h.m_z),h=l.m_x/d,d=l.m_y/d,c=l.m_z+m[a],m[a]=c,c>>>1!==l.m_z>>>1&&(d=h=0),c=2*a,f[c]=h,f[c+1]=d;return b.O3DGC_OK};b.SC3DMCDecoder.prototype.IQuantize=
function(a,d,c,e,f,s,m,l){var h,k;if(l.m_value===g.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION)for(k=g.CubeToSphere,l=this.m_orientation,h=this.m_normals,f=new b.Vec3(0,0,0),s=new b.Vec3(0,0,0),this.IQuantizeFloatArray(a,d,c,e,this.m_minNormal,this.m_maxNormal,m+1),c=0;c<d;++c)f.m_x=a[e*c]+h[2*c],f.m_y=a[e*c+1]+h[2*c+1],f.m_z=l[c],k[f.m_z](f,s),a[e*c]=s.m_x,a[e*c+1]=s.m_y,a[e*c+2]=s.m_z;else this.IQuantizeFloatArray(a,d,c,e,f,s,m)};b.SC3DMCDecoder.prototype.DecodeFloatArrayBinary=function(a,d,c,e,f,s,m,
l,h,k){var n,p,q,w,t,z,r,v,x,E,A,D,B,C,y,F,u,M,H,L,N,J,G;D=this.m_iterator;t=this.m_orientation;B=this.m_streamType;y=new b.ArithmeticDecoder;F=new b.StaticBitModel;u=new b.AdaptiveBitModel;M=new b.AdaptiveDataModel;w=g.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS;M.SetAlphabet(w+1);H=this.m_triangleListDecoder.GetVertexToTriangle();L=H.m_neighbors;N=l.GetCoordIndex();z=d*c;J=D.m_count;G=k.ReadUInt32(D,B);v=k.ReadUChar(D,B);B=v>>>4&7;h.m_value=v&7;G-=D.m_count-J;J=new b.Iterator;J.m_count=D.m_count+G;if(B!==
g.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return b.O3DGC_ERROR_CORRUPTED_STREAM;k=k.GetBuffer(D,G);D.m_count+=G;y.SetBuffer(G,k);y.StartDecoder();G=y.ExpGolombDecode(0,F,u);k=y.ExpGolombDecode(0,F,u);B=new b.AdaptiveDataModel;B.SetAlphabet(k+2);if(h.m_value===g.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){this.m_orientationSize<z&&(this.m_orientationSize=z,t=this.m_orientation=new Int8Array(this.m_orientationSize));c=new b.AdaptiveDataModel;c.SetAlphabet(12);for(r=0;r<d;++r)t[r]=I(y.DecodeAdaptiveDataModel(c));
this.ProcessNormals(l);c=2}this.m_quantFloatArraySize<z&&(this.m_quantFloatArraySize=z,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize));v=this.m_quantFloatArray;x=this.m_neighbors;E=new b.NumberRef;t=h.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION;z=h.m_value===g.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;for(A=0;A<d;++A){E.m_value=0;l=A*e;if(0<H.GetNumNeighbors(A)&&t){q=H.Begin(A);n=H.End(A);if(z)for(p=q;p<n;++p){r=L[p];if(0>r)break;P(N,r,A,E,x,H,L)}if(E.m_value<w)for(p=q;p<n;++p){r=L[p];if(0>
r)break;K(N,r,A,E,x)}}if(1<E.m_value)if(r=x[y.DecodeAdaptiveDataModel(M)],q=r.m_c*e,0>q)for(p=r.m_b*e,n=r.m_a*e,q=-q-e,r=0;r<c;++r)for(r=0;r<c;++r)C=y.DecodeIntACEGC(B,F,u,G,k),v[l+r]=C+v[n+r]+v[p+r]-v[q+r];else for(r=0;r<c;++r)for(r=0;r<c;++r)C=y.DecodeIntACEGC(B,F,u,G,k),v[l+r]=C+v[q+r];else if(0<A&&t)for(r=0;r<c;++r)C=y.DecodeIntACEGC(B,F,u,G,k),v[l+r]=C+v[(A-1)*e+r];else for(r=0;r<c;++r)C=y.DecodeUIntACEGC(B,F,u,G,k),v[l+r]=C}D.m_count=J.m_count;this.IQuantize(a,d,c,e,f,s,m,h);return b.O3DGC_OK};
b.SC3DMCDecoder.prototype.DecodeFloatArrayASCII=function(a,d,c,e,f,s,m,l,h,k){var n,p,q,w,t,z,r,v,x,E,A,D,B,C,y,F,u;w=g.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS;r=this.m_iterator;t=this.m_orientation;v=this.m_streamType;E=this.m_triangleListDecoder.GetVertexToTriangle();A=E.m_neighbors;D=l.GetCoordIndex();z=d*c;B=r.m_count;C=k.ReadUInt32(r,v);y=k.ReadUChar(r,v);F=y>>>4&7;h.m_value=y&7;C-=r.m_count-B;B=new b.Iterator;B.m_count=r.m_count+C;if(F!==g.O3DGC_SC3DMC_BINARIZATION_ASCII)return b.O3DGC_ERROR_CORRUPTED_STREAM;
k.ReadUInt32(B,v);if(h.m_value===g.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){this.m_orientationSize<d&&(this.m_orientationSize=d,t=this.m_orientation=new Int8Array(this.m_orientationSize));for(u=0;u<d;++u)t[u]=k.ReadIntASCII(r);this.ProcessNormals(l);c=2}this.m_quantFloatArraySize<z&&(this.m_quantFloatArraySize=z,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize));v=this.m_quantFloatArray;C=this.m_neighbors;F=new b.NumberRef;t=h.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION;z=h.m_value===g.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;
for(y=0;y<d;++y){F.m_value=0;l=y*e;if(0<E.GetNumNeighbors(y)&&t){p=E.Begin(y);q=E.End(y);if(z)for(u=p;u<q;++u){n=A[u];if(0>n)break;P(D,n,y,F,C,E,A)}if(F.m_value<w)for(u=p;u<q;++u){n=A[u];if(0>n)break;K(D,n,y,F,C)}}if(1<F.m_value)if(u=C[k.ReadUCharASCII(B)],q=u.m_c*e,0>q)for(p=u.m_b*e,n=u.m_a*e,q=-q-e,u=0;u<c;++u)for(u=0;u<c;++u)x=k.ReadIntASCII(r),v[l+u]=x+v[n+u]+v[p+u]-v[q+u];else for(u=0;u<c;++u)for(u=0;u<c;++u)x=k.ReadIntASCII(r),v[l+u]=x+v[q+u];else if(0<y&&h.m_value!==g.O3DGC_SC3DMC_NO_PREDICTION)for(u=
0;u<c;++u)x=k.ReadIntASCII(r),v[l+u]=x+v[(y-1)*e+u];else for(u=0;u<c;++u)x=k.ReadUIntASCII(r),v[l+u]=x}r.m_count=B.m_count;this.IQuantize(a,d,c,e,f,s,m,h);return b.O3DGC_OK};b.SC3DMCDecoder.prototype.DecodeFloatArray=function(a,b,c,e,f,s,m,l,h,k){return this.m_streamType===g.O3DGC_STREAM_TYPE_ASCII?this.DecodeFloatArrayASCII(a,b,c,e,f,s,m,l,h,k):this.DecodeFloatArrayBinary(a,b,c,e,f,s,m,l,h,k)};b.SC3DMCDecoder.prototype.IQuantizeFloatArray=function(a,d,c,e,f,g,m){var l,h,k,n;l=this.m_idelta;h=this.m_quantFloatArray;
for(k=0;k<c;++k)n=g[k]-f[k],l[k]=0<n?n/((1<<m>>>0)-1):1;for(g=0;g<d;++g)for(k=0;k<c;++k)a[g*e+k]=h[g*e+k]*l[k]+f[k];return b.O3DGC_OK};b.SC3DMCDecoder.prototype.DecodePlayload=function(a,d){var c,e,f,g,m,l,h;c=this.m_params;e=this.m_iterator;f=this.m_stats;g=new b.NumberRef;m=new b.Timer;l=b.O3DGC_OK;this.m_triangleListDecoder.SetStreamType(this.m_streamType);f.m_streamSizeCoordIndex=e.m_count;m.Tic();this.m_triangleListDecoder.Decode(a.GetCoordIndex(),a.GetNCoordIndex(),a.GetNCoord(),d,e);m.Toc();
f.m_timeCoordIndex=m.GetElapsedTime();f.m_streamSizeCoordIndex=e.m_count-f.m_streamSizeCoordIndex;f.m_streamSizeCoord=e.m_count;m.Tic();0<a.GetNCoord()&&(l=this.DecodeFloatArray(a.GetCoord(),a.GetNCoord(),3,3,a.GetCoordMinArray(),a.GetCoordMaxArray(),c.GetCoordQuantBits(),a,g,d),c.SetCoordPredMode(g.m_value));if(l!==b.O3DGC_OK)return l;m.Toc();f.m_timeCoord=m.GetElapsedTime();f.m_streamSizeCoord=e.m_count-f.m_streamSizeCoord;f.m_streamSizeNormal=e.m_count;m.Tic();0<a.GetNNormal()&&(l=this.DecodeFloatArray(a.GetNormal(),
a.GetNNormal(),3,3,a.GetNormalMinArray(),a.GetNormalMaxArray(),c.GetNormalQuantBits(),a,g,d),c.SetNormalPredMode(g.m_value));if(l!==b.O3DGC_OK)return l;m.Toc();f.m_timeNormal=m.GetElapsedTime();f.m_streamSizeNormal=e.m_count-f.m_streamSizeNormal;for(h=0;h<a.GetNumFloatAttributes();++h)f.m_streamSizeFloatAttribute[h]=e.m_count,m.Tic(),l=this.DecodeFloatArray(a.GetFloatAttribute(h),a.GetNFloatAttribute(h),a.GetFloatAttributeDim(h),a.GetFloatAttributeDim(h),a.GetFloatAttributeMinArray(h),a.GetFloatAttributeMaxArray(h),
c.GetFloatAttributeQuantBits(h),a,g,d),c.SetFloatAttributePredMode(h,g.m_value),m.Toc(),f.m_timeFloatAttribute[h]=m.GetElapsedTime(),f.m_streamSizeFloatAttribute[h]=e.m_count-f.m_streamSizeFloatAttribute[h];if(l!==b.O3DGC_OK)return l;for(h=0;h<a.GetNumIntAttributes();++h)f.m_streamSizeIntAttribute[h]=e.m_count,m.Tic(),l=this.DecodeIntArray(a.GetIntAttribute(h),a.GetNIntAttribute(h),a.GetIntAttributeDim(h),a.GetIntAttributeDim(h),a,g,d),c.SetIntAttributePredMode(h,g.m_value),m.Toc(),f.m_timeIntAttribute[h]=
m.GetElapsedTime(),f.m_streamSizeIntAttribute[h]=e.m_count-f.m_streamSizeIntAttribute[h];if(l!==b.O3DGC_OK)return l;m.Tic();this.m_triangleListDecoder.Reorder();m.Toc();f.m_timeReorder=m.GetElapsedTime();return l};b.DVEncodeParams=function(){this.m_encodeMode=g.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT;this.m_streamTypeMode=g.O3DGC_STREAM_TYPE_ASCII;this.m_quantBits=10};b.DVEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode};b.DVEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode};
b.DVEncodeParams.prototype.GetQuantBits=function(){return this.m_quantBits};b.DVEncodeParams.prototype.SetStreamType=function(a){this.m_streamTypeMode=a};b.DVEncodeParams.prototype.SetEncodeMode=function(a){this.m_encodeMode=a};b.DVEncodeParams.prototype.SetQuantBits=function(a){this.m_quantBits=a};b.DynamicVector=function(){this.m_stride=this.m_dim=this.m_num=0;this.m_max={};this.m_min={};this.m_vectors={}};b.DynamicVector.prototype.GetNVector=function(){return this.m_num};b.DynamicVector.prototype.GetDimVector=
function(){return this.m_dim};b.DynamicVector.prototype.GetStride=function(){return this.m_stride};b.DynamicVector.prototype.GetMinArray=function(){return this.m_min};b.DynamicVector.prototype.GetMaxArray=function(){return this.m_max};b.DynamicVector.prototype.GetVectors=function(){return this.m_vectors};b.DynamicVector.prototype.GetMin=function(a){return this.m_min[a]};b.DynamicVector.prototype.GetMax=function(a){return this.m_max[a]};b.DynamicVector.prototype.SetNVector=function(a){this.m_num=a};
b.DynamicVector.prototype.SetDimVector=function(a){this.m_dim=a};b.DynamicVector.prototype.SetStride=function(a){this.m_stride=a};b.DynamicVector.prototype.SetMinArray=function(a){this.m_min=a};b.DynamicVector.prototype.SetMaxArray=function(a){this.m_max=a};b.DynamicVector.prototype.SetMin=function(a,b){this.m_min[a]=b};b.DynamicVector.prototype.SetMax=function(a,b){this.m_max[a]=b};b.DynamicVector.prototype.SetVectors=function(a){this.m_vectors=a};b.DynamicVectorDecoder=function(){this.m_dimVectors=
this.m_numVectors=this.m_maxNumVectors=this.m_streamSize=0;this.m_quantVectors={};this.m_iterator=new b.Iterator;this.m_streamType=g.O3DGC_STREAM_TYPE_UNKOWN;this.m_params=new b.DVEncodeParams};b.DynamicVectorDecoder.prototype.GetStreamType=function(){return this.m_streamType};b.DynamicVectorDecoder.prototype.GetIterator=function(){return this.m_iterator};b.DynamicVectorDecoder.prototype.SetStreamType=function(a){this.m_streamType=a};b.DynamicVectorDecoder.prototype.SetIterator=function(a){this.m_iterator=
a};b.DynamicVectorDecoder.prototype.IUpdate=function(a,d,c){var e;e=c-1;c=2;for(a[d]-=a[d+1]>>1;c<e;)a[d+c]-=a[d+c-1]+a[d+c+1]+2>>2,c+=2;c===e&&(a[d+c]-=a[d+c-1]>>1);return b.O3DGC_OK};b.DynamicVectorDecoder.prototype.IPredict=function(a,d,c){var e;e=c-1;for(c=1;c<e;)a[d+c]+=a[d+c-1]+a[d+c+1]+1>>1,c+=2;c===e&&(a[d+c]+=a[d+c-1]);return b.O3DGC_OK};b.DynamicVectorDecoder.prototype.Merge=function(a,d,c){var e,f,g;e=(c>>1)+(c&1);c=e-1;for(f=e;0<c;){for(e=c;e<f;e+=2)g=a[d+e],a[d+e]=a[d+e+1],a[d+e+1]=g;
--c;++f}return b.O3DGC_OK};b.DynamicVectorDecoder.prototype.ITransform=function(a,d,c){var e,f;f=0;for(e=0+((c&1)<<f++>>>0);1<c;)c=(c>>1)+((c&1)>>>0),e+=(c&1)<<f++>>>0;for(f-=2;0<=f;--f)c=(c<<1>>>0)-(e>>>f&1)>>>0,this.Merge(a,d,c),this.IUpdate(a,d,c),this.IPredict(a,d,c);return b.O3DGC_OK};b.DynamicVectorDecoder.prototype.IQuantize=function(a,d,c,e,f,g,m){var l,h,k,n;l=this.m_quantVectors;for(k=0;k<c;++k)for(h=g[k]-f[k],h=0<h?h/((1<<m>>>0)-1):1,n=0;n<d;++n)a[n*e+k]=l[n+k*d]*h+f[k];return b.O3DGC_OK};
b.DynamicVectorDecoder.prototype.DecodeHeader=function(a,d){var c,e,f;c=this.m_iterator;e=c.m_count;f=d.ReadUInt32(c,g.O3DGC_STREAM_TYPE_BINARY);if(f!==g.O3DGC_DV_START_CODE){c.m_count=e;f=d.ReadUInt32(c,g.O3DGC_STREAM_TYPE_ASCII);if(f!==g.O3DGC_DV_START_CODE)return b.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=g.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=g.O3DGC_STREAM_TYPE_BINARY;e=this.m_streamType;this.m_streamSize=d.ReadUInt32(c,e);this.m_params.SetEncodeMode(d.ReadUChar(c,e));a.SetNVector(d.ReadUInt32(c,
e));0<a.GetNVector()&&(a.SetDimVector(d.ReadUInt32(c,e)),this.m_params.SetQuantBits(d.ReadUChar(c,e)));return b.O3DGC_OK};b.DynamicVectorDecoder.prototype.DecodePlayload=function(a,d){var c,e,f,s,m,l,h,k,n,p,q,w,t;e=this.m_iterator;f=this.m_streamType;s=b.O3DGC_OK;m=e.m_count;l=d.ReadUInt32(e,f);h=a.GetDimVector();k=a.GetNVector();c=h*k;for(n=0;n<a.GetDimVector();++n)a.SetMin(n,d.ReadFloat32(e,f)),a.SetMax(n,d.ReadFloat32(e,f));n=new b.ArithmeticDecoder;p=new b.StaticBitModel;q=new b.AdaptiveBitModel;
l-=e.m_count-m;w=m=0;f===g.O3DGC_STREAM_TYPE_BINARY&&(m=d.GetBuffer(e,l),e.m_count+=l,n.SetBuffer(l,m),n.StartDecoder(),m=n.ExpGolombDecode(0,p,q),w=n.ExpGolombDecode(0,p,q));l=new b.AdaptiveDataModel;l.SetAlphabet(w+2);this.m_maxNumVectors<c&&(this.m_maxNumVectors=c,this.m_quantVectors=new Int32Array(this.m_maxNumVectors));c=this.m_quantVectors;if(f===g.O3DGC_STREAM_TYPE_ASCII)for(f=0;f<k;++f)for(t=0;t<h;++t)c[t*k+f]=d.ReadIntASCII(e);else for(f=0;f<k;++f)for(t=0;t<h;++t)c[t*k+f]=n.DecodeIntACEGC(l,
p,q,m,w);for(t=0;t<h;++t)this.ITransform(c,t*k,k);this.IQuantize(a.GetVectors(),k,h,a.GetStride(),a.GetMinArray(),a.GetMaxArray(),this.m_params.GetQuantBits());return s};return b}();